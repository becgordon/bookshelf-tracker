{% extends 'base.html' %}

{% block title %}Showing results for {{ searchterm }}{% endblock %}

{% block body %}

<nav class="navbar sticky-top navbar-expand-lg bg-light">
    <div class="container-fluid">
      <a class="navbar-brand" href="/">Shelf-Help</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNavDropdown">
        <ul class="navbar-nav me-auto mb-2 mb-lg-0">
          <li class="nav-item">
            <a class="nav-link active" href="/userprofile/{{ session['user_name'] }}">My Library</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/usercharts/{{ session['user_name'] }}">Charts</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/viewallusers">View all users</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/usersettings/{{ session['user_name'] }}">Settings</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/logout">Log Out</a>
          </li>
    <div class="container-fluid">
        <form class="d-flex" role="search" method="GET" action="/booksearchresults" aria-current="page" >
          <input class="form-control me-2" type="search" placeholder="Search for a Book" aria-label="Search" name="search-term">
          <button class="btn btn-outline-success" type="submit">Search</button>
        </form>
      </div>
  </nav>

<form method="GET" action="/booksearchresults">
    <div>
        Advanced Search: <input type="text" name="search-term" placeholder="search term">
        <select name="search-type" id="search-type-select">
            <option value="intitle">In Title</option>
            <option value="inauthor">In Author</option>
            <option value="subject">Subject</option>
            <option value="publisher">Publisher</option>
        </select>
        <input type="text" name="advanced-search-term" placeholder="search by">
        <input type="submit">
      </div>
</form>

{% if books == [] %}
<h2>Hmmm, it looks like there weren't any results for that search term. Please try again.</h2>
{% endif %}

{% for book in books %}
<h2>{{ book['volumeInfo']['title'] }}</h2>
{% if 'authors' in book['volumeInfo'] %}
<div> {{ book['volumeInfo']['authors']|join(' ') }}</div>
{% endif %}
{% if 'imageLinks' in book['volumeInfo'] %}
<div>
    <a href="/bookprofile/{{ book['id'] }}"><img src="{{ book['volumeInfo']['imageLinks']['thumbnail'] }}"></a>
  </div>
{% endif %}
<div>--------------------------------------------------</div>
{% endfor %}

{% endblock %}